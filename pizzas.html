<!doctype html>
<head>
  <meta charset="utf-8">

  <title>pizza share</title>
  <meta name="description" content="My Parse App">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/styles.css">
  <script src="//www.parsecdn.com/js/parse-1.6.7.min.js"></script>
  <script src="main.js"></script
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

   <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom styles for this template -->
    <link href="css/cover.css" rel="stylesheet">
        <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
</head>

<body>
  
  <div id="main">
    <h1 id="test">Enter your location to find nearby pizza orders:</h1>

    <input type="text" placeHolder="Location (* for global)" id="locationField">
    <button id="findBtn">Find your pizza!</button>
    <h3>Select a pizza below:</h3>
    <br>
   <div class="row">
      <div class="content" id="list"></div>
    </div>



  <script type="text/javascript">
        Parse.initialize("7KqL30AZciYFanvE29SVJMJBUEJu4yTBpjFLhMrf", "o3sqlOBTBjSZsvfHxJexP7Zf58oDEv82Z1TxKFb9");

        var pizzasString = "";
        var $locationField = $('#locationField');
        var $findBtn = $('#findBtn');
        var myLoc = "";
        $findBtn.click(function(e) {
          $('.content').html("");
          myLoc = $locationField.val()
          showPizza(getFormInputs(), $(e.currentTarget));
        });
        function getFormInputs() {
          return { myLoc : $locationField.val() };
        }

        function showPizza(piza, findBtn)
        {
        var Pizzas = Parse.Object.extend("pizza");
        var query = new Parse.Query(Pizzas);
        query.equalTo("test", "test");
        query.find({
          success: function(results){
            //document.getElementById("list").innerHTML = "hey";
            //alert("Successfully retrieved " + results.length + " pizzas.");
            for (var i = 0; i < results.length; i++)
            {
              //document.getElementById("list").innerHTML = "hey";
              var object = results[i];
              //alert(object.id + ' - ' + object.get('creator'));
              //pizzasString += 'id="' + object.id + '">' + object.get('creator') + "</div>";
              if(object.get('location') == piza.myLoc || piza.myLoc == "*"){
              $('.content').prepend("<div style='border:1px solid black;' id='" + object.id + "'>" + "<h3>" + object.get('creator') + "<br>" + object.get('numSlices') + " slice(s) left!" + "</h3>" + object.get('updatedAt')  + "<div>" + object.get('topping1') + "<br>" + object.get('topping2') + "<br>" + object.get('topping3') +"</div>" + "</div><br>");
              }
            }
          },
          error: function(object, error) {

          }
        });
        }
        /*
        query.find({
        success: function(results) {
            results.each(function(results){
                console.log(results.get("creator"));
            });
        */
        //alert(pizzasString);
        //document.getElementById("list").innerHTML = pizzasString;
  </script>
</body>

</html>
